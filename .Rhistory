theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
reorder_mets$labels
(zscore_DAMs %>%
dplyr::select(Metabolite, Replicate, zScore) %>%
pivot_wider(id_cols = Metabolite,
names_from = Replicate,
values_from = zScore) %>%
as.data.frame(row.names = .$Metabolite))[-1]
zscore_DAMs %>%
dplyr::select(Metabolite, Replicate, zScore) %>%
pivot_wider(id_cols = Metabolite,
names_from = Replicate,
values_from = zScore)
zscore_DAMs %>%
dplyr::select(Metabolite, Replicate, zScore) %>%
pivot_wider(id_cols = Metabolite,
names_from = Replicate,
values_from = zScore) %>%
as.data.frame(row.names = .$Metabolite)
zscore_DAMs %>%
dplyr::select(Metabolite, Replicate, zScore) %>%
pivot_wider(id_cols = Metabolite,
names_from = Replicate,
values_from = zScore) %>%
data.frame(row.names = .$Metabolite)
reorder_mets <- (zscore_DAMs %>%
dplyr::select(Metabolite, Replicate, zScore) %>%
pivot_wider(id_cols = Metabolite,
names_from = Replicate,
values_from = zScore) %>%
data.frame(row.names = .$Metabolite))[-1] %>%
dist() %>% hclust()
zscore_DAMs %>%
mutate(ordered_Mets = Metabolite %>%
factor(levels = reorder_mets$labels[reorder_mets$order])) %>%
ggplot(aes(ordered_Mets, y = Replicate, fill = zScore)) +
geom_tile() +
scale_fill_gradientn(colors = rev(brewer.pal(11, "RdBu")),
name = "Fold change",
limits = c(-2, 2),
breaks = -2:2,
labels = -2:2) +
labs(x = "", y="", fill="Fold Change") +
theme_classic() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
zscore_DAMs <-
sapply(1:nrow(DAMs_abundance), simplify = F, \(x) {
metMean <- DAMs_abundance$Norm_abundance[x] %>%
mean(na.rm=T)
metSD=DAMs_abundance$Norm_abundance[x] %>%
sd(na.rm=T)
DAMs_abundance[x,] %>%
mutate(zScore = (Norm_abundance - metMean) /
metSD)
}) %>% list_rbind()
reorder_mets <- (zscore_DAMs %>%
dplyr::select(Metabolite, Replicate, zScore) %>%
pivot_wider(id_cols = Metabolite,
names_from = Replicate,
values_from = zScore) %>%
data.frame(row.names = .$Metabolite))[-1] %>%
dist() %>% hclust()
zscore_DAMs
x=1
metMean = DAMs_abundance$Norm_abundance[x] %>%
mean(na.rm=T)
metMean
metSD=DAMs_abundance$Norm_abundance[x] %>%
sd(na.rm=T)
metSD
DAMs_abundance$Norm_abundance[x] %>%
sd(na.rm=T)
DAMs_abundance$Norm_abundance[x]
summary_DAMs <- DAMs_abundance %>%
group_by(Metabolite) %>%
summarize(Mean_norm_abundance = mean(Norm_abundance, na.rm=T),
SD_norm_abundance = sd(Norm_abundance, na.rm=T))
zscore_DAMs <-
sapply(1:nrow(DAMs_abundance), simplify = F, \(x) {
Met=DAMs_abundance$Metabolite[x]
info = summary_DAMs %>%
filter(Clone == CloneID,
Metabolite == Met)
DAMs_abundance[x,] %>%
mutate(zScore = (Norm_abundance - info$Mean_norm_abundance) /
info$SD_norm_abundance)
}) %>% list_rbind()
info = summary_DAMs %>%
filter(Metabolite == Met)
zscore_DAMs <-
sapply(1:nrow(DAMs_abundance), simplify = F, \(x) {
Met=DAMs_abundance$Metabolite[x]
info = summary_DAMs %>%
filter(Metabolite == Met)
DAMs_abundance[x,] %>%
mutate(zScore = (Norm_abundance - info$Mean_norm_abundance) /
info$SD_norm_abundance)
}) %>% list_rbind()
reorder_mets <- (zscore_DAMs %>%
dplyr::select(Metabolite, Replicate, zScore) %>%
pivot_wider(id_cols = Metabolite,
names_from = Replicate,
values_from = zScore) %>%
data.frame(row.names = .$Metabolite))[-1] %>%
dist() %>% hclust()
zscore_DAMs %>%
mutate(ordered_Mets = Metabolite %>%
factor(levels = reorder_mets$labels[reorder_mets$order])) %>%
ggplot(aes(ordered_Mets, y = Replicate, fill = zScore)) +
geom_tile() +
scale_fill_gradientn(colors = rev(brewer.pal(11, "RdBu")),
name = "Fold change",
limits = c(-2, 2),
breaks = -2:2,
labels = -2:2) +
labs(x = "", y="", fill="Fold Change") +
theme_classic() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
range(zscore_DAMs$zScore)
zscore_DAMs %>%
mutate(ordered_Mets = Metabolite %>%
factor(levels = reorder_mets$labels[reorder_mets$order])) %>%
ggplot(aes(ordered_Mets, y = Replicate, fill = zScore)) +
geom_tile() +
scale_fill_gradientn(colors = rev(brewer.pal(11, "RdBu")),
name = "Fold change",
limits = c(-3, 3),
breaks = -3:3,
labels = -3:3) +
labs(x = "", y="", fill="Fold Change") +
theme_classic() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
zscore_DAMs %>%
mutate(ordered_Mets = Metabolite %>%
factor(levels = reorder_mets$labels[reorder_mets$order])) %>%
ggplot(aes(ordered_Mets, y = Replicate, fill = zScore)) +
geom_tile() +
scale_fill_gradientn(colors = rev(brewer.pal(11, "RdBu")),
name = "Fold change",
limits = c(-3, 3),
breaks = -3:3,
labels = -3:3) +
labs(x = "", y="", fill="Fold Change") +
facet_wrap(~Clone, nrow = 4) +
theme_classic() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
zscore_DAMs %>%
mutate(ordered_Mets = Metabolite %>%
factor(levels = reorder_mets$labels[reorder_mets$order])) %>%
ggplot(aes(ordered_Mets, y = Replicate, fill = zScore)) +
geom_tile() +
scale_fill_gradientn(colors = rev(brewer.pal(11, "RdBu")),
name = "Fold change",
limits = c(-3, 3),
breaks = -3:3,
labels = -3:3) +
labs(x = "", y="", fill="Fold Change") +
facet_wrap(~Clone, nrow = 4, drop = T) +
theme_classic() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
zscore_DAMs %>%
mutate(ordered_Mets = Metabolite %>%
factor(levels = reorder_mets$labels[reorder_mets$order])) %>%
ggplot(aes(ordered_Mets, y = Replicate, fill = zScore)) +
geom_tile() +
scale_fill_gradientn(colors = rev(brewer.pal(11, "RdBu")),
name = "Fold change",
limits = c(-3, 3),
breaks = -3:3,
labels = -3:3) +
labs(x = "", y="", fill="Fold Change") +
facet_wrap(~Clone, nrow = 4, drop = T, "free_y") +
theme_classic() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
zscore_DAMs %>%
mutate(ordered_Mets = Metabolite %>%
factor(levels = reorder_mets$labels[reorder_mets$order])) %>%
ggplot(aes(ordered_Mets, y = Replicate, fill = zScore)) +
geom_tile() +
scale_fill_gradientn(colors = rev(brewer.pal(11, "RdBu")),
name = "Fold change",
limits = c(-3, 3),
breaks = -3:3,
labels = -3:3) +
labs(x = "", y="", fill="Fold Change") +
facet_wrap(~Clone, nrow = 4, drop = T, scales = "free_y") +
theme_classic() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
zscore_DAMs %>%
mutate(ordered_Mets = Metabolite %>%
factor(levels = reorder_mets$labels[reorder_mets$order])) %>%
ggplot(aes(ordered_Mets, y = Replicate, fill = zScore)) +
geom_tile() +
scale_fill_gradientn(colors = rev(brewer.pal(11, "RdBu")),
name = "Fold change",
limits = c(-3, 3),
breaks = -3:3,
labels = -3:3) +
labs(x = "", y="", fill="Fold Change") +
facet_wrap(~Clone, nrow = 4, drop = T, scales = "free_y",
labeller = "") +
theme_classic() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
str)
zscore_DAMs %>%
mutate(ordered_Mets = Metabolite %>%
factor(levels = reorder_mets$labels[reorder_mets$order])) %>%
ggplot(aes(ordered_Mets, y = Replicate, fill = zScore)) +
geom_tile() +
scale_fill_gradientn(colors = rev(brewer.pal(11, "RdBu")),
name = "Fold change",
limits = c(-3, 3),
breaks = -3:3,
labels = -3:3) +
labs(x = "", y="", fill="Fold Change") +
facet_wrap(~Clone, nrow = 4, drop = T, scales = "free_y",
strip.position = "none") +
theme_classic() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
str)
zscore_DAMs %>%
mutate(ordered_Mets = Metabolite %>%
factor(levels = reorder_mets$labels[reorder_mets$order])) %>%
ggplot(aes(ordered_Mets, y = Replicate, fill = zScore)) +
geom_tile() +
scale_fill_gradientn(colors = rev(brewer.pal(11, "RdBu")),
name = "Fold change",
limits = c(-3, 3),
breaks = -3:3,
labels = -3:3) +
labs(x = "", y="", fill="Fold Change") +
facet_wrap(~Clone, nrow = 4, drop = T, scales = "free_y",
strip.position = "none") +
theme_classic() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
zscore_DAMs %>%
mutate(ordered_Mets = Metabolite %>%
factor(levels = reorder_mets$labels[reorder_mets$order])) %>%
ggplot(aes(ordered_Mets, y = Replicate, fill = zScore)) +
geom_tile() +
scale_fill_gradientn(colors = rev(brewer.pal(11, "RdBu")),
name = "Fold change",
limits = c(-3, 3),
breaks = -3:3,
labels = -3:3) +
labs(x = "", y="", fill="Fold Change") +
facet_wrap(~Clone, nrow = 4, drop = T, scales = "free_y") +
theme_classic() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
zscore_DAMs %>%
mutate(ordered_Mets = Metabolite %>%
factor(levels = reorder_mets$labels[reorder_mets$order])) %>%
ggplot(aes(ordered_Mets, y = Replicate, fill = Norm_abundance)) +
geom_tile() +
scale_fill_gradientn(colors = rev(brewer.pal(11, "RdBu")),
name = "Fold change",
limits = c(-3, 3),
breaks = -3:3,
labels = -3:3) +
labs(x = "", y="", fill="Fold Change") +
facet_wrap(~Clone, nrow = 4, drop = T, scales = "free_y") +
theme_classic() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
range(zscore_DAMs$Norm_abundance)
zscore_DAMs %>%
mutate(ordered_Mets = Metabolite %>%
factor(levels = reorder_mets$labels[reorder_mets$order])) %>%
ggplot(aes(ordered_Mets, y = Replicate, fill = Norm_abundance)) +
geom_tile() +
scale_fill_gradientn(colors = rev(brewer.pal(11, "RdBu")),
name = "Fold change",
limits = c(-4, 4),
breaks = -4:4,
labels = -4:4) +
labs(x = "", y="", fill="Fold Change") +
facet_wrap(~Clone, nrow = 4, drop = T, scales = "free_y") +
theme_classic() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
zscore_DAMs %>%
mutate(ordered_Mets = Metabolite %>%
factor(levels = reorder_mets$labels[reorder_mets$order])) %>%
ggplot(aes(ordered_Mets, y = Replicate, fill = Norm_abundance)) +
geom_tile() +
scale_fill_gradientn(colors = rev(brewer.pal(11, "RdBu")),
name = "Fold change",
limits = c(-4, 4),
breaks = -4:4,
labels = -4:4) +
labs(x = "", y="", fill="Fold Change") +
facet_wrap(~Clone, nrow = 4, drop = T, scales = "free_y") +
theme_classic() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank(),
panel.spacing.y = unit(1, "mm"))
zscore_DAMs %>%
mutate(ordered_Mets = Metabolite %>%
factor(levels = reorder_mets$labels[reorder_mets$order])) %>%
ggplot(aes(ordered_Mets, y = Replicate, fill = Norm_abundance)) +
geom_tile() +
scale_fill_gradientn(colors = rev(brewer.pal(11, "RdBu")),
name = "Fold change",
limits = c(-4, 4),
breaks = -4:4,
labels = -4:4) +
labs(x = "", y="", fill="Fold Change") +
facet_wrap(~Clone, nrow = 4, drop = T, scales = "free_y") +
theme_classic() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank(),
panel.spacing.y = unit(.5, "mm"))
zscore_DAMs %>%
mutate(ordered_Mets = Metabolite %>%
factor(levels = reorder_mets$labels[reorder_mets$order])) %>%
ggplot(aes(ordered_Mets, y = Replicate, fill = Norm_abundance)) +
geom_tile() +
scale_fill_gradientn(colors = rev(brewer.pal(11, "RdBu")),
name = "Fold change",
limits = c(-4, 4),
breaks = -4:4,
labels = -4:4) +
labs(x = "", y="", fill="Fold Change") +
facet_wrap(~Clone, nrow = 4, drop = T, scales = "free_y") +
theme_classic() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank(),
panel.spacing.y = unit(0, "mm"))
zscore_DAMs %>%
mutate(ordered_Mets = Metabolite %>%
factor(levels = reorder_mets$labels[reorder_mets$order])) %>%
ggplot(aes(ordered_Mets, y = Replicate, fill = Norm_abundance)) +
geom_tile() +
scale_fill_gradientn(colors = rev(brewer.pal(11, "RdBu")),
name = "Fold change",
limits = c(-4, 4),
breaks = -4:4,
labels = -4:4) +
labs(x = "", y="", fill="Fold Change") +
facet_wrap(~Clone, nrow = 4, drop = T, scales = "free_y") +
theme_classic() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank(),
panel.spacing.y = unit(-1, "mm"))
zscore_DAMs %>%
mutate(ordered_Mets = Metabolite %>%
factor(levels = reorder_mets$labels[reorder_mets$order])) %>%
ggplot(aes(ordered_Mets, y = Replicate, fill = Norm_abundance)) +
geom_tile() +
scale_fill_gradientn(colors = rev(brewer.pal(11, "RdBu")),
name = "Fold change",
limits = c(-4, 4),
breaks = -4:4,
labels = -4:4) +
labs(x = "", y="", fill="Fold Change") +
facet_wrap(~Clone, nrow = 4, drop = T, scales = "free_y") +
theme_classic() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank(),
panel.spacing.y = unit(-2, "mm"))
zscore_DAMs %>%
mutate(ordered_Mets = Metabolite %>%
factor(levels = reorder_mets$labels[reorder_mets$order])) %>%
ggplot(aes(ordered_Mets, y = Replicate, fill = Norm_abundance)) +
geom_tile() +
scale_fill_gradientn(colors = rev(brewer.pal(11, "RdBu")),
name = "Fold change",
limits = c(-4, 4),
breaks = -4:4,
labels = -4:4) +
labs(x = "", y="", fill="Normalized\nabundance",
caption="Analytes deregulated in three analysis modes,") +
facet_wrap(~Clone, nrow = 4, drop = T, scales = "free_y") +
theme_classic() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank(),
panel.spacing.y = unit(-2, "mm"))
zscore_DAMs %>%
mutate(ordered_Mets = Metabolite %>%
factor(levels = reorder_mets$labels[reorder_mets$order])) %>%
ggplot(aes(ordered_Mets, y = Replicate, fill = Norm_abundance)) +
geom_tile() +
scale_fill_gradientn(colors = rev(brewer.pal(11, "RdBu")),
limits = c(-4, 4),
breaks = -4:4,
labels = -4:4) +
labs(x = "", y="", fill="Normalized\nabundance",
caption="Analytes deregulated in three analysis modes,") +
facet_wrap(~Clone, nrow = 4, drop = T, scales = "free_y") +
theme_classic() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank(),
panel.spacing.y = unit(-2, "mm"))
zscore_DAMs %>%
mutate(ordered_Mets = Metabolite %>%
factor(levels = reorder_mets$labels[reorder_mets$order])) %>%
ggplot(aes(ordered_Mets, y = Replicate, fill = Norm_abundance)) +
geom_tile() +
scale_fill_gradientn(colors = rev(brewer.pal(11, "RdBu")),
limits = c(-4, 4),
breaks = -4:4,
labels = -4:4) +
labs(x = "", y="", fill="Normalized\nabundance",
caption="Normalized abundance of deregulated analytes (all three analysis modes)") +
facet_wrap(~Clone, nrow = 4, drop = T, scales = "free_y") +
theme_classic() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank(),
panel.spacing.y = unit(-2, "mm"))
seq(-4, -4, 2)
seq(-4, 4, 2)
zscore_DAMs %>%
mutate(ordered_Mets = Metabolite %>%
factor(levels = reorder_mets$labels[reorder_mets$order])) %>%
ggplot(aes(ordered_Mets, y = Replicate, fill = Norm_abundance)) +
geom_tile() +
scale_fill_gradientn(colors = rev(brewer.pal(11, "RdBu")),
limits = c(-4, 4),
breaks = seq(-4, 4, 2),
labels = seq(-4, 4, 2)) +
labs(x = "", y="", fill="Normalized\nabundance",
caption="Normalized abundance of deregulated analytes (all three analysis modes)") +
facet_wrap(~Clone, nrow = 4, drop = T, scales = "free_y") +
theme_classic() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank(),
panel.spacing.y = unit(-2, "mm"))
nDAMs = length(reorder_mets$order)
Deregulated analytes:", nDAMs) +
zscore_DAMs %>%
mutate(ordered_Mets = Metabolite %>%
factor(levels = reorder_mets$labels[reorder_mets$order])) %>%
ggplot(aes(ordered_Mets, y = Replicate, fill = Norm_abundance)) +
geom_tile() +
scale_fill_gradientn(colors = rev(brewer.pal(11, "RdBu")),
limits = c(-4, 4),
breaks = seq(-4, 4, 2),
labels = seq(-4, 4, 2)) +
labs(x = "", y="", fill="Normalized\nabundance",
caption=paste("Normalized abundance of deregulated analytes (all three analysis modes).
Deregulated analytes:", nDAMs)) +
facet_wrap(~Clone, nrow = 4, drop = T, scales = "free_y") +
theme_classic() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank(),
panel.spacing.y = unit(-2, "mm"))
ggsave("plots/Relative_abundance_DAAs.pdf",
height = 6, width = 8)
